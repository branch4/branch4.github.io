<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Linux | branch4 Blog]]></title>
  <link href="http://blog.branch4.pw/blog/categories/linux/atom.xml" rel="self"/>
  <link href="http://blog.branch4.pw/"/>
  <updated>2014-08-10T17:44:59+09:00</updated>
  <id>http://blog.branch4.pw/</id>
  <author>
    <name><![CDATA[root4]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Troubles Upgrading Ubuntu]]></title>
    <link href="http://blog.branch4.pw/blog/2012/06/05/troubles-upgrading-ubuntu/"/>
    <updated>2012-06-05T11:22:00+09:00</updated>
    <id>http://blog.branch4.pw/blog/2012/06/05/troubles-upgrading-ubuntu</id>
    <content type="html"><![CDATA[<div  class=post>
  Many times I upgrade Ubuntu, my window widgets(titles and side bars) go away.  <br> <br>
  Just a memo on how to recover it.  <br> <br>
  I use compiz and it looks like the compiz configs go away in upgrade procedure.  <br> <br>
  So the first thing I do is, boot compiz configuration manager, <br> <br>
  and check on "Window Decoration".  <br> <br>
  That should do.
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Slackware on KVM]]></title>
    <link href="http://blog.branch4.pw/blog/2012/03/11/slackware-on-kvm/"/>
    <updated>2012-03-11T02:07:00+09:00</updated>
    <id>http://blog.branch4.pw/blog/2012/03/11/slackware-on-kvm</id>
    <content type="html"><![CDATA[<p>こんにちは。KVM でSlackware動かしてみようかなー、と思った<a href="https://twitter.com/xengineer01">@xengineer01</a>です。</p>

<h2>概要</h2>

<p>特に目新しいことはなく、タイトル通りですわ。<br/>
まずは、Google様に、"slackware"と聞いてみて、<a href="http://www.slackware.com">本家サイト</a>へ。<br/>
で、どっかのミラーからslackware64のisoを拝借して、md5のcheckだけしとく。</p>

<p><code>
% md5sum -c slackware64-14.1-xxx.iso
% cat slackwar64-14.1-xxx.md5
</code></p>

<p>僕が15年くらい前にはじめてLinuxインストールしたのがSlackware3.2くらいの頃だったので、<br/>
majorバージョンでいうと11あがってるのか。でもなんか途中で、沢山バージョン飛ばしてた気が。</p>

<table>
<thead>
<tr>
<th align="center">Version </th>
<th align="center"> Releasedate     </th>
<th align="center"> End-of-life date </th>
<th align="center"> Kernel version</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">1.00    </td>
<td align="center"> 17 July 1993    </td>
<td align="center">         ??       </td>
<td align="center"> 0.99.11 Alpha</td>
</tr>
<tr>
<td align="center">1.1     </td>
<td align="center"> 5 November 1993 </td>
<td align="center">         ??       </td>
<td align="center"> 0.99.13</td>
</tr>
<tr>
<td align="center">2.0     </td>
<td align="center">   2 July 1994   </td>
<td align="center">          ??      </td>
<td align="center"> 1.0.9</td>
</tr>
<tr>
<td align="center">2.1     </td>
<td align="center"> 31 October 1994 </td>
<td align="center">  ??              </td>
<td align="center"> 1.1.59</td>
</tr>
<tr>
<td align="center">2.2     </td>
<td align="center"> 30 March 1995   </td>
<td align="center"> ??               </td>
<td align="center"> 1.2.1</td>
</tr>
<tr>
<td align="center">2.3     </td>
<td align="center"> 24 May 1995     </td>
<td align="center"> ??               </td>
<td align="center"> 1.2.8</td>
</tr>
<tr>
<td align="center">3.0     </td>
<td align="center">30 November 1995 </td>
<td align="center"> ??               </td>
<td align="center"> 1.2.13</td>
</tr>
<tr>
<td align="center">3.1     </td>
<td align="center">  3 June 1996    </td>
<td align="center"> ??               </td>
<td align="center"> 2.0.0</td>
</tr>
<tr>
<td align="center">3.2     </td>
<td align="center">17 February 1997 </td>
<td align="center"> ??               </td>
<td align="center"> 2.0.29</td>
</tr>
<tr>
<td align="center">3.3     </td>
<td align="center"> 11 June 1997    </td>
<td align="center"> ??               </td>
<td align="center"> 2.0.30</td>
</tr>
<tr>
<td align="center">3.4     </td>
<td align="center"> 14 October 1997 </td>
<td align="center"> ??               </td>
<td align="center"> 2.0.30</td>
</tr>
<tr>
<td align="center">3.5     </td>
<td align="center">  9 June 1998    </td>
<td align="center"> ??               </td>
<td align="center"> 2.0.34</td>
</tr>
<tr>
<td align="center">3.6     </td>
<td align="center"> 28 October 1998 </td>
<td align="center"> ??               </td>
<td align="center"> 2.0.35</td>
</tr>
<tr>
<td align="center">3.9     </td>
<td align="center"> 10 May 1999     </td>
<td align="center"> ??               </td>
<td align="center"> 2.0.37pre10</td>
</tr>
<tr>
<td align="center">4.0     </td>
<td align="center"> 17 May 1999     </td>
<td align="center"> ??               </td>
<td align="center"> 2.2.6</td>
</tr>
<tr>
<td align="center">7.0     </td>
<td align="center"> 25 October 1999 </td>
<td align="center"> ??               </td>
<td align="center"> 2.2.13</td>
</tr>
<tr>
<td align="center">7.1     </td>
<td align="center"> 22 June 2000    </td>
<td align="center"> ??               </td>
<td align="center"> 2.2.16</td>
</tr>
<tr>
<td align="center">8.0     </td>
<td align="center">  1 July 2001    </td>
<td align="center"> ??               </td>
<td align="center"> 2.2.19</td>
</tr>
<tr>
<td align="center">8.1     </td>
<td align="center"> 18 June 2002    </td>
<td align="center"> 1 August 2012    </td>
<td align="center"> 2.4.18</td>
</tr>
<tr>
<td align="center">9.0     </td>
<td align="center"> 19 March 2003   </td>
<td align="center"> 1 August 2012    </td>
<td align="center"> 2.4.20</td>
</tr>
<tr>
<td align="center">9.1     </td>
<td align="center">26 September 2003</td>
<td align="center"> 1 August 2012    </td>
<td align="center"> 2.4.22</td>
</tr>
<tr>
<td align="center">10.0    </td>
<td align="center"> 23 June 2004    </td>
<td align="center"> 1 August 2012    </td>
<td align="center"> 2.4.26</td>
</tr>
<tr>
<td align="center">10.1    </td>
<td align="center">  2 February 2005</td>
<td align="center"> 1 August 2012    </td>
<td align="center"> 2.4.29</td>
</tr>
<tr>
<td align="center">10.2    </td>
<td align="center">14 September 2005</td>
<td align="center"> 1 August 2012    </td>
<td align="center"> 2.4.31</td>
</tr>
<tr>
<td align="center">11.0    </td>
<td align="center">  2 October 2006 </td>
<td align="center">1 August 2012     </td>
<td align="center"> 2.4.33.3</td>
</tr>
<tr>
<td align="center">12.0    </td>
<td align="center">  1 July 2007    </td>
<td align="center">1 August 2012     </td>
<td align="center"> 2.6.21.5</td>
</tr>
<tr>
<td align="center">12.1    </td>
<td align="center">  2 May 2008     </td>
<td align="center">9 December 2013   </td>
<td align="center"> 2.6.24.5</td>
</tr>
<tr>
<td align="center">12.2    </td>
<td align="center">10 December 2008 </td>
<td align="center">9 December 2013   </td>
<td align="center"> 2.6.27.7</td>
</tr>
<tr>
<td align="center">13.0    </td>
<td align="center"> 26 August 2009  </td>
<td align="center"> ??               </td>
<td align="center"> 2.6.29.6</td>
</tr>
<tr>
<td align="center">13.1    </td>
<td align="center"> 24 May 2010     </td>
<td align="center"> ??               </td>
<td align="center"> 2.6.33.4</td>
</tr>
<tr>
<td align="center">13.37   </td>
<td align="center"> 27 April 2011   </td>
<td align="center"> ??               </td>
<td align="center"> 2.6.37.6</td>
</tr>
<tr>
<td align="center">14.0    </td>
<td align="center">28 September 2012</td>
<td align="center"> ??               </td>
<td align="center"> 3.2.29</td>
</tr>
<tr>
<td align="center">14.1    </td>
<td align="center"> 4 November 2013 </td>
<td align="center"> ??               </td>
<td align="center"> 3.10.17</td>
</tr>
</tbody>
</table>


<p>おお、4.0 &ndash;> 7.0で飛んでるね！この間、3.5と4.0は使った記憶があるけど、<br/>
あとはインストールすらしていない・・・</p>

<p>なにはともあれインストール。<br/>
<a href="http://www.linuxquestions.org/questions/slackware-14/slackware64-current-kvm-guest-boot-issue-871981/">ここ</a>を参考に。</p>

<p>1 CPUが仮想化支援対応してるかの確認をする<br/>
<code>
$ grep -E 'vmx|svm' /proc/cpuinfo  
</code></p>

<p>vmx : Intel VT support
svm : AMD-V support</p>

<p><a href="http://www.intel.co.jp/content/www/jp/ja/virtualization/virtualization-technology/hardware-assist-virtualization-technology.html">Intel VT by Intel</a>
<a href="http://ja.wikipedia.org/wiki/%E3%82%A4%E3%83%B3%E3%83%86%E3%83%AB_%E3%83%90%E3%83%BC%E3%83%81%E3%83%A3%E3%83%A9%E3%82%A4%E3%82%BC%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%83%BB%E3%83%86%E3%82%AF%E3%83%8E%E3%83%AD%E3%82%B8%E3%83%BC">Intel VT wiki</a>
<a href="http://www.atmarkit.co.jp/fsys/kaisetsu/085intelvt/intelvt.html">Intel VT by @IT</a></p>

<p><a href="http://gihyo.jp/dev/serial/01/vm_work/0005">Intel VT &amp; AMD-V by gihyo</a></p>

<p><a href="http://www.amd.com/ja-jp/solutions/servers/virtualization">AMD-V by AMD</a>
<a href="http://itpro.nikkeibp.co.jp/article/COLUMN/20061013/250707/">AMD-V by It-pro</a></p>

<p>対応してないと、、、遅いっす。<br/>
CeleronとかAtomじゃなければ最近のCPUで対応してないものは少ないと思うけど。<br/>
そしてぐぐってみて思ったけど、AMD-Vのほうが情報が凄く少ない気がする・・・</p>

<p>VT技術サポートしなかったら、インストールできません！というわけじゃないけど、<br/>
すこぶる重いので、環境見直してからのほうがよいと思います。</p>

<p>2 install kvm and bridge-utils
```</p>

<h1>apt-get install kvm bridge-utils</h1>

<p><code>
3 Add user (that executes kvm) to group kvm
</code></p>

<h1>adduser <user> kvm</h1>

<p><code>
4 prepare images
</code>
$ kvm-img create -f qcow <somename>.img 10G<br/>
```
5 prepare guest OS images or CDs</p>

<p>I used ISO file.</p>

<p>```</p>

<h1>mount -t iso9660 -o loop <isofile> <mount point></h1>

<p><code>
6 execute kvm
</code>
$ kvm -drive file=/usr/local/kvm_images/slak01.img,if=virtio,boot=on -cdrom /usr/local/os_images/slackware64-13.37-install-dvd.iso -boot d -m 512 -monitor stdio<br/>
```
Then, you&rsquo;ll be seeing Slackware installer boot.<br/>
Now, never forget to use virtio.<br/>
You need this to install Slackware.</p>

<p>7 install Slackware
  You do this, Just as you install Slack on physical server,
  except that you&rsquo;ll fail to install LILO.<br/>
  * never choose btrfs as a filesystem for /boot, lilo don&rsquo;t like it<br/>
8 exit setup(we&rsquo;re gonna install LILO from here)<br/>
9 mount devices/sys/proc &ndash;> chroot
```</p>

<h1>mount -obind /dev /mnt/dev</h1>

<h1>mount -obind /sys /mnt/sys</h1>

<h1>mount -t proc proc /proc /mnt/proc chroot /mnt</h1>

<p>```
10 make initrd<br/>
  Edit mkinitrd.conf</p>

<p>```</p>

<h1>cd /etc/</h1>

<h1>cp mkinitrd.conf.sample mkinitrd.conf</h1>

<h1>vi mkinitrd.conf</h1>

<p>```
  Edit following lines:</p>

<p><code>
MODULE_LIST="ext4:virtio_blk:virtio_pci"
ROOTFS="ext4"
ROOTDEV="/dev/vda3"  
</code></p>

<p>  Get a command line for making initrd.</p>

<p>```</p>

<h1>/usr/share/mkinitrd/mkinitrd_command_generator.sh -r</h1>

<h1>&gt;execute above command&rsquo;s output here! &lt;</h1>

<p><code>
11. edit lilo.conf
</code></p>

<h1>vi /etc/lilo.conf</h1>

<p>```</p>

<p>  Add following line after boot = /dev/vda</p>

<p><code>
disk = /dev/vda bios=0x80 max-partitions=7  
</code>
  Add following line after image = /boot/vmlinuz
<code>
initrd = /boot/initrd.gz  
</code>
  Comment out root = /dev/vda3.</p>

<ol>
<li>install LILO
```

<h1>lilo</h1>

<p>```</p></li>
<li>reboot
```

<h1>reboot</h1>

<p>```</p></li>
<li>pray it to boot up</li>
</ol>


<p>That&rsquo;s all for today.<br/>
That did it for me, I think.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Slackware on KVM]]></title>
    <link href="http://blog.branch4.pw/blog/2012/03/11/slackware-on-kvm/"/>
    <updated>2012-03-11T02:07:00+09:00</updated>
    <id>http://blog.branch4.pw/blog/2012/03/11/slackware-on-kvm</id>
    <content type="html"><![CDATA[<div  class=post>
  It's probably nothing new.
  <br>
  <br>
  Below are the sites that I checked.
  <br>
  <a  href=http://www.grocock.me.uk/blog/booting-slackware-from-a-virtio-hard-disk-in-a-kvm-virtual-machine/>http://www.grocock.me.uk/blog/booting-slackware-from-a-virtio-hard-disk-in-a-kvm-virtual-machine/</a>
  <br>
  <a  href=http://www.linuxquestions.org/questions/slackware-14/slackware64-current-kvm-guest-boot-issue-871981/>http://www.linuxquestions.org/questions/slackware-14/slackware64-current-kvm-guest-boot-issue-871981/</a>
  <br>
  <br>
  1. check your CPU for HW support <br> <br>
  $ grep -E 'vmx|svm' /proc/cpuinfo <br> <br>
  2. install kvm and bridge-utils <br>
  # apt-get install kvm bridge-utils <br> <br>
  3. Add user (that executes kvm) to group kvm <br>
  # adduser <user> kvm <br> <br>
  4. prepare images <br>
  $ kvm-img create -f qcow <somename>.img 10G <br> <br>
  5. prepare guest OS images or CDs <br> <br>
  I used ISO file.  <br>
  # mount -t iso9660 -o loop <isofile> <mount point> <br> <br>
  6. execute kvm <br>
  $ kvm -drive file=/usr/local/kvm_images/slak01.img,if=virtio,boot=on -cdrom /usr/local/os_images/slackware64-13.37-install-dvd.iso -boot d -m 512 -monitor stdio <br> <br>
  Then, you'll be seeing Slackware installer boot.  <br>
  Now, never forget to use virtio.  <br>
  You need this to install Slackware.  <br> <br>
  7. install Slackware <br>
  You do this, Just as you install Slack on physical server, <br>
  except that you'll fail to install LILO.  <br>
  * never choose btrfs as a filesystem for /boot, lilo don't like it <br> <br>
  8. exit setup(we're gonna install LILO from here) <br> <br>
  9. mount devices/sys/proc -> chroot <br>
  # mount -obind /dev /mnt/dev <br> <br>
  # mount -obind /sys /mnt/sys <br>
  # mount -t proc proc /proc /mnt/proc chroot /mnt <br> <br>
  10. make initrd <br> <br>
  Edit mkinitrd.conf <br>
  # cd /etc/ <br>
  # cp mkinitrd.conf.sample mkinitrd.conf <br>
  # vi mkinitrd.conf <br> <br>
  Edit following lines: <br>
  MODULE_LIST="ext4:virtio_blk:virtio_pci" <br>
  ROOTFS="ext4" <br>
  ROOTDEV="/dev/vda3" <br> <br>
  Get a command line for making initrd.  <br>
  # /usr/share/mkinitrd/mkinitrd_command_generator.sh -r <br>
  # <execute above command's output ! > <br> <br>
  11. edit lilo.conf <br>
  # vi /etc/lilo.conf <br> <br>
  Add following line after boot = /dev/vda <br>
  disk = /dev/vda bios=0x80 max-partitions=7 <br> <br>
  Add following line after image = /boot/vmlinuz <br>
  initrd = /boot/initrd.gz <br> <br>
  Comment out root = /dev/vda3.  <br> <br>
  12. install LILO <br>
  # lilo <br> <br>
  13. reboot <br>
  # reboot <br> <br>
  14. pray it to boot up <br> <br>
  That's all for today.  <br>
  That did it for me, I think.  <br>
  <!-- Place this tag where you want the +1 button to render. -->
  <div class="g-plusone" data-annotation="inline" data-width="300"></div>
  <!-- Place this tag after the last +1 button tag. -->
  <script  type=text/javascript>
    
(function() {
  var po = document.createElement('script');
  po.type = 'text/javascript';
  po.async = true;
  po.src = 'https://apis.google.com/js/plusone.js';
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(po, s);
})(); 

  </script>
</div>


<h2 >
  Comments
</h2>


<div  class=comments>
  <div  class=comment>
    <div  class=author>
      xengineer
    </div>
    <div  class=content>
      I am glad to hear that.
      <br>
      I hope you enjoy it.
    </div>
  </div>
  <div  class=comment>
    <div  class=author>
      Aleksei K
    </div>
    <div  class=content>
      xengineer, thanks for you reply.
      <br>
      i boot vm from cd and after mkinitrd with params all works fine.
    </div>
  </div>
  <div  class=comment>
    <div  class=author>
      xengineer
    </div>
    <div  class=content>
      Aleksei K <br>
      I am sorry to be late.  <br>
      I was out of town for a while.  <br> <br>
      It seems to me that you could have missed something in step 10.  <br>
      When you generate the initial ram disk image.  <br> <br>
      Maybe the following lines.  <br> <br>
      Get a command line for making initrd.  <br>
      # /usr/share/mkinitrd/mkinitrd_command_generator.sh -r <br>
      # <execute above command's output ! >
      <br>
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
      <br>
      <br>
      Where you have to execute the output of previously executed command.  <br>
      Can you see if this works ?
    </div>
  </div>
  <div  class=comment>
    <div  class=author>
      Aleksei K
    </div>
    <div  class=content>
      then i do something wrong my vm output is: <br>
      VFS: Cannot open root device "fc01" or unknown-block(252,1) <br>
      Please append a correct "root=" boot options; here are the available partitions: <br>
      0b00 1048575 sr0 driver: sr <br>
      ----------- <br> <br>
      maybe i miss something.
    </div>
  </div>
  <div  class=comment>
    <div  class=author>
      xengineer
    </div>
    <div  class=content>
      Hi Aleksei K.  <br> <br>
      This is my slice.  <br> <br>
      /dev/vda3 => / <br>
      /dev/vda2 => /boot <br>
      and a swap partition.  <br> <br>
      On lilo.conf, I put <br> <br>
      lba32 <br>
      boot = /dev/vda <br>
      disk = /dev/vda bios=0x80 max-partitions=7 <br>
      image = /boot/vmlinuz <br>
      initrd = /boot/initrd.gz <br> <br>
      (there are other configs, but the above configs only matters if we are talking about slices)
    </div>
  </div>
  <div  class=comment>
    <div  class=author>
      Aleksei K
    </div>
    <div  class=content>
      what partition do you have on /dev/vda?  <br>
      if i have 3 /boot and /, [swap] partitions, what is my lilo.conf?
    </div>
  </div>
</div>

]]></content>
  </entry>
  
</feed>
